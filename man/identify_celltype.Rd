% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identify_celltype.R
\name{identify_celltype}
\alias{identify_celltype}
\title{Identify cell types from marker genes using AI models}
\usage{
identify_celltype(
  genes,
  model = "claude-3-5-sonnet-20241022",
  tissue_context = NULL,
  species = "human",
  save_results = FALSE,
  output_file = NULL,
  llm = "claude"
)
}
\arguments{
\item{genes}{A character vector of gene symbols/names to analyze. Gene names 
should follow standard nomenclature (e.g., HUGO symbols for human genes).}

\item{model}{A character string specifying the AI model to use. Default is 
"claude-3-5-sonnet-20241022". Model options by LLM:
\itemize{
  \item Claude: "claude-3-5-sonnet-20241022", "claude-3-opus-20240229", "claude-3-haiku-20240307"
  \item Gemini: "gemini-1.5-pro", "gemini-1.5-flash", "gemini-1.0-pro"
  \item ChatGPT: "gpt-4o", "gpt-4-turbo", "gpt-4", "gpt-3.5-turbo"
}}

\item{tissue_context}{An optional character string specifying the tissue 
context (e.g., "peripheral blood", "brain", "liver"). This helps improve 
prediction accuracy by providing biological context.}

\item{species}{A character string specifying the species. Must be one of: 
"human", "mouse", "rat", "zebrafish", "drosophila". Default is "human".}

\item{save_results}{A logical value indicating whether to save results to 
an RDS file. Default is FALSE.}

\item{output_file}{An optional character string specifying the output file 
path. If NULL and save_results is TRUE, a timestamped filename will be 
generated automatically.}

\item{llm}{A character string specifying which language model service to use. 
Must be one of "claude", "gemini", or "chatgpt". Default is "claude".}
}
\value{
A list containing:
  \item{genes_queried}{Character vector of genes that were analyzed}
  \item{model_used}{Character string of the AI model used}
  \item{llm_used}{Character string of the LLM service used}
  \item{tissue_context}{Character string of tissue context (if provided)}
  \item{species}{Character string of the species analyzed}
  \item{response}{Character string containing the AI model's response}
  \item{timestamp}{POSIXct timestamp of when the analysis was performed}
}
\description{
This function takes a list of marker genes and uses large language models 
(Claude or Gemini) to predict the most likely cell type(s) based on gene 
expression patterns. The function provides context-aware predictions 
considering tissue type and species.
}
\details{
The function constructs a biological prompt asking the AI model to identify 
cell types based on the provided marker genes. The prompt requests:
\itemize{
  \item Most likely cell type(s) with confidence levels
  \item Key supporting genes from the input list
  \item Alternative possibilities
  \item Brief biological rationale
}

The function requires the \code{ellmer} package for AI model communication 
and \code{glue} for prompt construction.
}
\examples{
\dontrun{
# Basic usage with T cell markers
markers <- c("CD3D", "CD3E", "CD8A", "CD8B", "GZMB", "PRF1")
result <- identify_celltype(markers)

# With tissue context
result <- identify_celltype(markers, tissue_context = "peripheral blood")

# Using Gemini instead of Claude
result <- identify_celltype(markers, llm = "gemini")

# Using ChatGPT
result <- identify_celltype(markers, llm = "chatgpt")

# Save results to file
result <- identify_celltype(markers, save_results = TRUE)

# Mouse genes
mouse_markers <- c("Cd3d", "Cd3e", "Cd8a", "Cd8b")
result <- identify_celltype(mouse_markers, species = "mouse")

# Using specific models
result <- identify_celltype(markers, llm = "claude", model = "claude-3-opus-20240229")
result <- identify_celltype(markers, llm = "gemini", model = "gemini-1.5-pro")
result <- identify_celltype(markers, llm = "chatgpt", model = "gpt-4o")
}

}
\seealso{
\code{\link[ellmer]{chat_claude}}, \code{\link[ellmer]{chat_gemini}}, \code{\link[ellmer]{chat_openai}}
}
